@page
@model CamposRepresentacoes.Pages.Clientes.EditarClienteModel
@{
}
<html lang="pt-br">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
</head>
<body>
    <h2>Editar Cliente</h2>
    <div class="row">
        <div class="col-sm-6">
            <form method="post">
                <input type="hidden" asp-for="Cliente.Id"/>
                <div class="form-group">
                    <label for="razaoSocial">Razão Social:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-building"></i></span>
                        </div>
                        <input type="text" name="Cliente.RazaoSocial" class="form-control" asp-for="Cliente.RazaoSocial" required />
                    </div>
                </div>
                <div class="form-group">
                    <label for="cnpj">CNPJ:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                        </div>
                        <input type="text" class="form-control" data-inputmask='"mask": "99.999.999/9999-99"' data-mask name="Cliente.CNPJ"
                               asp-for="Cliente.CNPJ" required />
                    </div>
                </div>
                <div class="input-group mb-3">
                    <label for="email">Email:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                        </div>
                        <input type="email" name="Cliente.Email" class="form-control" asp-for="Cliente.Email" placeholder="Email" required />
                    </div>
                </div>
                <div class="form-group">
                    <label for="cep">CEP:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                        </div>
                        <input type="text" class="form-control" data-inputmask='"mask": "99999-999"' data-mask name="Cliente.CEP"
                               asp-for="Cliente.CEP" required onchange="buscarEnderecoPorCEP(this.value)" />
                    </div>
                </div>
                <div class="form-group">
                    <label for="rua">Rua:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-road"></i></span>
                        </div>
                        <input type="text" name="Cliente.Rua" class="form-control" asp-for="Cliente.Rua" required />
                    </div>
                </div>
                <div class="form-group">
                    <label for="bairro">Bairro:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                        </div>
                        <input type="text" name="Cliente.Bairro" class="form-control" asp-for="Cliente.Bairro" required />
                    </div>
                </div>
                <div class="form-group">
                    <label for="Cidade">Cidade:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-city"></i></span>
                        </div>
                        <input type="text" name="Cliente.Cidade" class="form-control" asp-for="Cliente.Cidade" required />
                    </div>
                </div>
                <div class="form-group">
                    <label for="numero">Número:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-sort-numeric-up"></i></span>
                        </div>
                        <input type="number" name="Cliente.Numero" class="form-control" asp-for="Cliente.Numero" required />
                    </div>
                </div>
                <div class="form-group">
                    <label for="Complemento">Complemento:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-sticky-note"></i></span>
                        </div>
                        <input type="text" name="Cliente.Complemento" class="form-control" asp-for="Cliente.Complemento" />
                    </div>
                </div>
                <div class="form-group">
                    <label for="telefone">Telefone com DDD:</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-phone"></i></span>
                        </div>
                        <input type="text" class="form-control" data-inputmask='"mask": "(99) 99999-9999"' data-mask name="Cliente.Telefone"
                               asp-for="Cliente.Telefone" required />
                    </div>
                </div>
                <div class="form-group">
                    <label asp-for="Cliente.Status">Status:</label>
                    <select class="form-control" name="Cliente.Status">
                        <option value="true">Ativo</option>
                        <option value="false">Inativo</option>
                    </select>
                </div>
                <div class="form-group">
                    <a class="btn btn-danger" href="/Clientes/Index">Voltar</a>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    @section scripts {
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="~/AdminLTE-3.2.0/AdminLTE-3.2.0/plugins/inputmask/jquery.inputmask.min.js"></script>
        <script>
            function buscarEnderecoPorCEP(cep) {
                // Remova espaços e traços do CEP
                cep = cep.replace(/\D/g, '');

                // Verifica se o CEP tem o formato válido
                if (cep.length === 8) {
                    // Monta a URL da API do ViaCEP
                    var url = 'https://viacep.com.br/ws/' + cep + '/json/';

                    // Faz a requisição AJAX
                    $.ajax({
                        url: url,
                        type: 'GET',
                        dataType: 'json',
                        success: function (data) {
                            // Preenche os campos com os dados obtidos
                            if (data) {
                                $('input[name="Cliente.Rua"]').val(data.logradouro);
                                $('input[name="Cliente.Bairro"]').val(data.bairro);
                                $('input[name="Cliente.Cidade"]').val(data.localidade);
                            }
                        },
                        error: function (error) {
                            console.log(error);
                            // Trate o erro conforme necessário
                        }
                    });
                }
            }

            $('[data-mask]').inputmask()

            var mensagemSucesso = '@MensagemAlerta.GetMensagem("MsgAlteracao")';
            if (mensagemSucesso) {
                alert(mensagemSucesso);

                window.location.href = '/Clientes/Index';
            }
        </script>
    }

</body>
</html>